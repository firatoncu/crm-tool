generator client {
  provider = "prisma-client-js"
  previewFeatures = ["driverAdapters"]
}

datasource db {
  provider = "postgresql"
}

model Customer {
  id            String       @id @default(uuid())
  companyName   String       @map("company_name")
  phone         String
  email         String?
  city          String?
  district      String?
  address       String?
  customerType  CustomerType @default(POTENTIAL) @map("customer_type")
  notes         String?
  contactPerson String?      @map("contact_person")
  createdAt     DateTime     @default(now()) @map("created_at")
  updatedAt     DateTime     @updatedAt @map("updated_at")
  isActive      Boolean      @default(true) @map("is_active")

  activities    Activity[]

  @@map("customers")
  @@index([phone])
  @@index([companyName])
}

model Activity {
  id          String       @id @default(uuid())
  customerId  String       @map("customer_id")
  type        ActivityType
  title       String
  description String?
  createdBy   String       @map("created_by")
  createdAt   DateTime     @default(now()) @map("created_at")

  // Attachments stored as JSON
  attachments Json?

  customer    Customer     @relation(fields: [customerId], references: [id])

  @@map("activities")
  @@index([customerId, createdAt])
}

enum CustomerType {
  DEALER
  AUTHORIZED_SERVICE
  ACTIVE
  POTENTIAL
  CORPORATE_END_USER
  PROJECT_CUSTOMER
  INDIVIDUAL
  EXPORT_DISTRIBUTOR
  EXPORT_PROJECT
}

enum ActivityType {
  INTRO_CALL
  WHATSAPP_MESSAGE
  EMAIL
  QUOTE_SENT
  SHIPMENT
  INSTALLATION
  NOTE
}
